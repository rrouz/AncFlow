Building DAG of jobs...
Using shell: /bin/bash
Provided cores: 4
Rules claiming more threads will be scaled down.
Job stats:
job             count
------------  -------
nex_to_fasta        1
total               1

Select jobs to execute...

[Sat Aug 26 00:50:05 2023]
rule nex_to_fasta:
    input: autophy_out.nex
    output: autophy_out.fasta
    jobid: 0
    reason: Missing output files: autophy_out.fasta
    resources: tmpdir=/var/folders/6w/cbbj2d4d1cs82bbv3lr2jt700000gn/T

RuleException in rule nex_to_fasta in file /Users/ryinrouzbehani/Documents/SDSU/Research/WF1/Snakefile, line 112:
NameError: The name 'seq' is unknown in this context. Please make sure that you defined that variable. Also note that braces not used for variable access have to be escaped by repeating them, i.e. {{print $1}}, when formatting the following:

        python - <<EOF
import re
import sys

input_nex_file = "{input.nex_file}"
output_fasta_file = "{output.fasta_file}"

with open(input_nex_file, "r") as nex_file:
    nex_content = nex_file.read()

matrix_match = re.search(r'MATRIX(.+?);', nex_content, re.DOTALL)
if matrix_match:
    matrix_content = matrix_match.group(1)
    sequences = re.findall(r"([A-Za-z0-9\-\.\|_]+)\s+'[^']+'", matrix_content)

    with open(output_fasta_file, "w") as fasta_file:
        for seq in sequences:
            fasta_file.write(f">{seq}\n{seq}\n")
else:
    raise ValueError("MATRIX section not found in the .nex file")
EOF
        
